/*! For license information please see vendor~c78bddac-13eded739767b66f0c03.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{pCNJ:function(e,s,i){var n;!function(){"use strict";var r=!("undefined"==typeof window||!window.document||!window.document.createElement),a={canUseDOM:r,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:r&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:r&&!!window.screen};void 0===(n=function(){return a}.call(s,i,s,e))||(e.exports=n)}()},vyiI:function(e,s,i){(function(e,i,n){!function(r,a){!function(s){"use strict";function t(e,s,i){return s in e?Object.defineProperty(e,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[s]=i,e}var r="undefined"!=typeof self?self:e;const a="undefined"!=typeof navigator,h=a&&"undefined"==typeof HTMLImageElement,c=!(void 0===e||void 0===i||!i.versions||!i.versions.node),y=r.Buffer,w=!!y,f=e=>void 0!==e;function l(e){return void 0===e||(e instanceof Map?0===e.size:0===Object.values(e).filter(f).length)}function o(e){let s=new Error(e);throw delete s.stack,s}function u(e){let s=function(e){let s=0;return e.ifd0.enabled&&(s+=1024),e.exif.enabled&&(s+=2048),e.makerNote&&(s+=2048),e.userComment&&(s+=1024),e.gps.enabled&&(s+=512),e.interop.enabled&&(s+=100),e.ifd1.enabled&&(s+=1024),s+2048}(e);return e.jfif.enabled&&(s+=50),e.xmp.enabled&&(s+=2e4),e.iptc.enabled&&(s+=14e3),e.icc.enabled&&(s+=6e3),s}const d=e=>String.fromCharCode.apply(null,e),b="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):void 0;class p{static from(e,s){return e instanceof this&&e.le===s?e:new p(e,void 0,void 0,s)}constructor(e,s=0,i,n){if("boolean"==typeof n&&(this.le=n),Array.isArray(e)&&(e=new Uint8Array(e)),0===e)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){void 0===i&&(i=e.byteLength-s);let n=new DataView(e,s,i);this._swapDataView(n)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof p){void 0===i&&(i=e.byteLength-s),(s+=e.byteOffset)+i>e.byteOffset+e.byteLength&&o("Creating view outside of available memory in ArrayBuffer");let n=new DataView(e.buffer,s,i);this._swapDataView(n)}else if("number"==typeof e){let s=new DataView(new ArrayBuffer(e));this._swapDataView(s)}else o("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,s,i=p){return e instanceof DataView||e instanceof p?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||o("BufferView.set(): Invalid data argument."),this.toUint8().set(e,s),new i(this,s,e.byteLength)}subarray(e,s){return s=s||this._lengthToEnd(e),new p(this,e,s)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,s){return new Uint8Array(this.buffer,this.byteOffset+e,s)}getString(e=0,s=this.byteLength){return i=this.getUint8Array(e,s),b?b.decode(i):w?n.from(i).toString("utf8"):decodeURIComponent(escape(d(i)));var i}getLatin1String(e=0,s=this.byteLength){let i=this.getUint8Array(e,s);return d(i)}getUnicodeString(e=0,s=this.byteLength){const i=[];for(let n=0;n<s&&e+n<this.byteLength;n+=2)i.push(this.getUint16(e+n));return d(i)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,s=this.le){return this.dataView.getInt16(e,s)}getInt32(e,s=this.le){return this.dataView.getInt32(e,s)}getUint16(e,s=this.le){return this.dataView.getUint16(e,s)}getUint32(e,s=this.le){return this.dataView.getUint32(e,s)}getFloat32(e,s=this.le){return this.dataView.getFloat32(e,s)}getFloat64(e,s=this.le){return this.dataView.getFloat64(e,s)}getFloat(e,s=this.le){return this.dataView.getFloat32(e,s)}getDouble(e,s=this.le){return this.dataView.getFloat64(e,s)}getUintBytes(e,s,i){switch(s){case 1:return this.getUint8(e,i);case 2:return this.getUint16(e,i);case 4:return this.getUint32(e,i);case 8:return this.getUint64&&this.getUint64(e,i)}}getUint(e,s,i){switch(s){case 8:return this.getUint8(e,i);case 16:return this.getUint16(e,i);case 32:return this.getUint32(e,i);case 64:return this.getUint64&&this.getUint64(e,i)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function g(e,s){o(`${e} '${s}' was not loaded, try using full build of exifr.`)}class m extends Map{constructor(e){super(),this.kind=e}get(e,s){return this.has(e)||g(this.kind,e),s&&(e in s||function(e,s){o(`Unknown ${e} '${s}'.`)}(this.kind,e),s[e].enabled||g(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var k=new m("file parser"),O=new m("segment parser"),I=new m("file reader");let L=r.fetch;const P="Invalid input argument";function v(e,s){return(i=e).startsWith("data:")||i.length>1e4?A(e,s,"base64"):c&&e.includes("://")?S(e,s,"url",U):c?A(e,s,"fs"):a?S(e,s,"url",U):void o(P);var i}async function S(e,s,i,n){return I.has(i)?A(e,s,i):n?async function(e,s){let i=await s(e);return new p(i)}(e,n):void o(`Parser ${i} is not loaded`)}async function A(e,s,i){let n=new(I.get(i))(e,s);return await n.read(),n}const U=e=>L(e).then((e=>e.arrayBuffer())),x=e=>new Promise(((s,i)=>{let n=new FileReader;n.onloadend=()=>s(n.result||new ArrayBuffer),n.onerror=i,n.readAsArrayBuffer(e)}));class C extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function B(e,s,i){let n=new C;for(let[e,s]of i)n.set(e,s);if(Array.isArray(s))for(let i of s)e.set(i,n);else e.set(s,n);return n}function V(e,s,i){let n,r=e.get(s);for(n of i)r.set(n[0],n[1])}const T=new Map,z=new Map,F=new Map,E=37500,j=37510,D=33723,M=34675,_=34665,N=34853,R=40965,$=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],W=["jfif","xmp","icc","iptc","ihdr"],K=["tiff",...W],X=["ifd0","ifd1","exif","gps","interop"],H=[...K,...X],J=["makerNote","userComment"],q=["translateKeys","translateValues","reviveValues","multiSegment"],ne=[...q,"sanitize","mergeOutput","silentErrors"];class Y{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class G extends Y{get needed(){return this.enabled||this.deps.size>0}constructor(e,s,i,n){if(super(),t(this,"enabled",!1),t(this,"skip",new Set),t(this,"pick",new Set),t(this,"deps",new Set),t(this,"translateKeys",!1),t(this,"translateValues",!1),t(this,"reviveValues",!1),this.key=e,this.enabled=s,this.parse=this.enabled,this.applyInheritables(n),this.canBeFiltered=X.includes(e),this.canBeFiltered&&(this.dict=T.get(e)),void 0!==i)if(Array.isArray(i))this.parse=this.enabled=!0,this.canBeFiltered&&i.length>0&&this.translateTagSet(i,this.pick);else if("object"==typeof i){if(this.enabled=!0,this.parse=!1!==i.parse,this.canBeFiltered){let{pick:e,skip:s}=i;e&&e.length>0&&this.translateTagSet(e,this.pick),s&&s.length>0&&this.translateTagSet(s,this.skip)}this.applyInheritables(i)}else!0===i||!1===i?this.parse=this.enabled=i:o(`Invalid options argument: ${i}`)}applyInheritables(e){let s,i;for(s of q)i=e[s],void 0!==i&&(this[s]=i)}translateTagSet(e,s){if(this.dict){let i,n,{tagKeys:r,tagValues:a}=this.dict;for(i of e)"string"==typeof i?(n=a.indexOf(i),-1===n&&(n=r.indexOf(Number(i))),-1!==n&&s.add(Number(r[n]))):s.add(i)}else for(let i of e)s.add(i)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,te(this.pick,this.deps)):this.enabled&&this.pick.size>0&&te(this.pick,this.deps)}}var oe={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},pe=new Map;class Q extends Y{static useCached(e){let s=pe.get(e);return void 0!==s||(s=new this(e),pe.set(e,s)),s}constructor(e){super(),!0===e?this.setupFromTrue():void 0===e?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):"object"==typeof e?this.setupFromObject(e):o(`Invalid options argument ${e}`),void 0===this.firstChunkSize&&(this.firstChunkSize=a?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of $)this[e]=oe[e];for(e of ne)this[e]=oe[e];for(e of J)this[e]=oe[e];for(e of H)this[e]=new G(e,oe[e],void 0,this)}setupFromTrue(){let e;for(e of $)this[e]=oe[e];for(e of ne)this[e]=oe[e];for(e of J)this[e]=!0;for(e of H)this[e]=new G(e,!0,void 0,this)}setupFromArray(e){let s;for(s of $)this[s]=oe[s];for(s of ne)this[s]=oe[s];for(s of J)this[s]=oe[s];for(s of H)this[s]=new G(s,!1,void 0,this);this.setupGlobalFilters(e,void 0,X)}setupFromObject(e){let s;for(s of(X.ifd0=X.ifd0||X.image,X.ifd1=X.ifd1||X.thumbnail,Object.assign(this,e),$))this[s]=ee(e[s],oe[s]);for(s of ne)this[s]=ee(e[s],oe[s]);for(s of J)this[s]=ee(e[s],oe[s]);for(s of K)this[s]=new G(s,oe[s],e[s],this);for(s of X)this[s]=new G(s,oe[s],e[s],this.tiff);this.setupGlobalFilters(e.pick,e.skip,X,H),!0===e.tiff?this.batchEnableWithBool(X,!0):!1===e.tiff?this.batchEnableWithUserValue(X,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,X):"object"==typeof e.tiff&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,X)}batchEnableWithBool(e,s){for(let i of e)this[i].enabled=s}batchEnableWithUserValue(e,s){for(let i of e){let e=s[i];this[i].enabled=!1!==e&&void 0!==e}}setupGlobalFilters(e,s,i,n=i){if(e&&e.length){for(let e of n)this[e].enabled=!1;let s=Z(e,i);for(let[e,i]of s)te(this[e].pick,i),this[e].enabled=!0}else if(s&&s.length){let e=Z(s,i);for(let[s,i]of e)te(this[s].skip,i)}}filterNestedSegmentTags(){let{ifd0:e,exif:s,xmp:i,iptc:n,icc:r}=this;this.makerNote?s.deps.add(E):s.skip.add(E),this.userComment?s.deps.add(j):s.skip.add(j),i.enabled||e.skip.add(700),n.enabled||e.skip.add(D),r.enabled||e.skip.add(M)}traverseTiffDependencyTree(){let{ifd0:e,exif:s,gps:i,interop:n}=this;n.needed&&(s.deps.add(R),e.deps.add(R)),s.needed&&e.deps.add(_),i.needed&&e.deps.add(N),this.tiff.enabled=X.some((e=>!0===this[e].enabled))||this.makerNote||this.userComment;for(let e of X)this[e].finalizeFilters()}get onlyTiff(){return!W.map((e=>this[e].enabled)).some((e=>!0===e))&&this.tiff.enabled}checkLoadedPlugins(){for(let e of K)this[e].enabled&&!O.has(e)&&g("segment parser",e)}}function Z(e,s){let i,n,r,a,h=[];for(r of s){for(a of(i=T.get(r),n=[],i))(e.includes(a[0])||e.includes(a[1]))&&n.push(a[0]);n.length&&h.push([r,n])}return h}function ee(e,s){return void 0!==e?e:void 0!==s?s:void 0}function te(e,s){for(let i of s)e.add(i)}t(Q,"default",oe);class se{constructor(e){t(this,"parsers",{}),t(this,"output",{}),t(this,"errors",[]),t(this,"pushToErrors",(e=>this.errors.push(e))),this.options=Q.useCached(e)}async read(e){this.file=await function(e,s){return"string"==typeof e?v(e,s):a&&!h&&e instanceof HTMLImageElement?v(e.src,s):e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof DataView?new p(e):a&&e instanceof Blob?S(e,s,"blob",x):void o(P)}(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,s=e.getUint16(0);for(let[i,n]of k)if(n.canHandle(e,s))return this.fileParser=new n(this.options,this.file,this.parsers),e[i]=!0;this.file.close&&this.file.close(),o("Unknown file format")}async parse(){let{output:e,errors:s}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),s.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&s.length>0&&(e.errors=s),l(i=e)?void 0:i;var i}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let s=Object.values(this.parsers).map((async s=>{let i=await s.parse();s.assignToOutput(e,i)}));this.options.silentErrors&&(s=s.map((e=>e.catch(this.pushToErrors)))),await Promise.all(s)}async extractThumbnail(){this.setup();let{options:e,file:s}=this,i=O.get("tiff",e);var n;if(s.tiff?n={start:0,type:"tiff"}:s.jpeg&&(n=await this.fileParser.getOrFindSegment("tiff")),void 0===n)return;let r=await this.fileParser.ensureSegmentChunk(n),a=this.parsers.tiff=new i(r,e,s),h=await a.extractThumbnail();return s.close&&s.close(),h}}async function ie(e,s){let i=new se(s);return await i.read(e),i.parse()}var ge=Object.freeze({__proto__:null,parse:ie,Exifr:se,fileParsers:k,segmentParsers:O,fileReaders:I,tagKeys:T,tagValues:z,tagRevivers:F,createDictionary:B,extendDictionary:V,fetchUrlAsArrayBuffer:U,readBlobAsArrayBuffer:x,chunkedProps:$,otherSegments:W,segments:K,tiffBlocks:X,segmentsAndBlocks:H,tiffExtractables:J,inheritables:q,allFormatters:ne,Options:Q});class re{static findPosition(e,s){let i=e.getUint16(s+2)+2,n="function"==typeof this.headerLength?this.headerLength(e,s,i):this.headerLength,r=s+n,a=i-n;return{offset:s,length:i,headerLength:n,start:r,size:a,end:r+a}}static parse(e,s={}){return new this(e,new Q({[this.type]:s}),e).parse()}normalizeInput(e){return e instanceof p?e:new p(e)}constructor(e,s={},i){t(this,"errors",[]),t(this,"raw",new Map),t(this,"handleError",(e=>{if(!this.options.silentErrors)throw e;this.errors.push(e.message)})),this.chunk=this.normalizeInput(e),this.file=i,this.type=this.constructor.type,this.globalOptions=this.options=s,this.localOptions=s[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,s){let i=F.get(s),n=z.get(s),r=T.get(s),a=this.options[s],h=a.reviveValues&&!!i,c=a.translateValues&&!!n,y=a.translateKeys&&!!r,w={};for(let[s,a]of e)h&&i.has(s)?a=i.get(s)(a):c&&n.has(s)&&(a=this.translateValue(a,n.get(s))),y&&r.has(s)&&(s=r.get(s)||s),w[s]=a;return w}translateValue(e,s){return s[e]||s.DEFAULT||e}assignToOutput(e,s){this.assignObjectToOutput(e,this.constructor.type,s)}assignObjectToOutput(e,s,i){if(this.globalOptions.mergeOutput)return Object.assign(e,i);e[s]?Object.assign(e[s],i):e[s]=i}}function ae(e){return 192===e||194===e||196===e||219===e||221===e||218===e||254===e}function he(e){return e>=224&&e<=239}function fe(e,s,i){for(let[n,r]of O)if(r.canHandle(e,s,i))return n}t(re,"headerLength",4),t(re,"type",void 0),t(re,"multiSegment",!1),t(re,"canHandle",(()=>!1));class le extends class{constructor(e,s,i){t(this,"errors",[]),t(this,"ensureSegmentChunk",(async e=>{let s=e.start,i=e.size||65536;if(this.file.chunked)if(this.file.available(s,i))e.chunk=this.file.subarray(s,i);else try{e.chunk=await this.file.readChunk(s,i)}catch(s){o(`Couldn't read segment: ${JSON.stringify(e)}. ${s.message}`)}else this.file.byteLength>s+i?e.chunk=this.file.subarray(s,i):void 0===e.size?e.chunk=this.file.subarray(s):o("Segment unreachable: "+JSON.stringify(e));return e.chunk})),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=s,this.parsers=i}injectSegment(e,s){this.options[e].enabled&&this.createParser(e,s)}createParser(e,s){let i=new(O.get(e))(s,this.options,this.file);return this.parsers[e]=i}createParsers(e){for(let s of e){let{type:e,chunk:i}=s,n=this.options[e];if(n&&n.enabled){let s=this.parsers[e];s&&s.append||s||this.createParser(e,i)}}}async readSegments(e){let s=e.map(this.ensureSegmentChunk);await Promise.all(s)}}{constructor(...e){super(...e),t(this,"appSegments",[]),t(this,"jpegSegments",[]),t(this,"unknownSegments",[])}static canHandle(e,s){return 65496===s}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){!0===e?(this.findAll=!0,this.wanted=new Set(O.keyList())):(e=void 0===e?O.keyList().filter((e=>this.options[e].enabled)):e.filter((e=>this.options[e].enabled&&O.has(e))),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,s){this.setupSegmentFinderArgs(s);let{file:i,findAll:n,wanted:r,remaining:a}=this;if(!n&&this.file.chunked&&(n=Array.from(r).some((e=>{let s=O.get(e),i=this.options[e];return s.multiSegment&&i.multiSegment})),n&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,i.byteLength),!this.options.onlyTiff&&i.chunked){let s=!1;for(;a.size>0&&!s&&(i.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:n}=i,r=this.appSegments.some((e=>!this.file.available(e.offset||e.start,e.length||e.size)));if(s=e>n&&!r?!await i.readNextChunk(e):!await i.readNextChunk(n),void 0===(e=this.findAppSegmentsInRange(e,i.byteLength)))return}}}findAppSegmentsInRange(e,s){s-=2;let i,n,r,a,h,c,{file:y,findAll:w,wanted:b,remaining:k,options:I}=this;for(;e<s;e++)if(255===y.getUint8(e))if(i=y.getUint8(e+1),he(i)){if(n=y.getUint16(e+2),r=fe(y,e,n),r&&b.has(r)&&(a=O.get(r),h=a.findPosition(y,e),c=I[r],h.type=r,this.appSegments.push(h),!w&&(a.multiSegment&&c.multiSegment?(this.unfinishedMultiSegment=h.chunkNumber<h.chunkCount,this.unfinishedMultiSegment||k.delete(r)):k.delete(r),0===k.size)))break;I.recordUnknownSegments&&(h=re.findPosition(y,e),h.marker=i,this.unknownSegments.push(h)),e+=n+1}else if(ae(i)){if(n=y.getUint16(e+2),218===i&&!1!==I.stopAfterSos)return;I.recordJpegSegments&&this.jpegSegments.push({offset:e,length:n,marker:i}),e+=n+1}return e}mergeMultiSegments(){if(!this.appSegments.some((e=>e.multiSegment)))return;let e=function(e,s){let i,n,r,a=new Map;for(let h=0;h<e.length;h++)i=e[h],n=i[s],a.has(n)?r=a.get(n):a.set(n,r=[]),r.push(i);return Array.from(a)}(this.appSegments,"type");this.mergedAppSegments=e.map((([e,s])=>{let i=O.get(e,this.options);return i.handleMultiSegments?{type:e,chunk:i.handleMultiSegments(s)}:s[0]}))}getSegment(e){return this.appSegments.find((s=>s.type===e))}async getOrFindSegment(e){let s=this.getSegment(e);return void 0===s&&(await this.findAppSegments(0,[e]),s=this.getSegment(e)),s}}t(le,"type","jpeg"),k.set("jpeg",le);const me=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class ue extends re{parseHeader(){var e=this.chunk.getUint16();18761===e?this.le=!0:19789===e&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,s,i=new Map){let{pick:n,skip:r}=this.options[s];n=new Set(n);let a=n.size>0,h=0===r.size,c=this.chunk.getUint16(e);e+=2;for(let y=0;y<c;y++){let c=this.chunk.getUint16(e);if(a){if(n.has(c)&&(i.set(c,this.parseTag(e,c,s)),n.delete(c),0===n.size))break}else!h&&r.has(c)||i.set(c,this.parseTag(e,c,s));e+=12}return i}parseTag(e,s,i){let{chunk:n}=this,r=n.getUint16(e+2),a=n.getUint32(e+4),h=me[r];if(h*a<=4?e+=8:e=n.getUint32(e+8),(r<1||r>13)&&o(`Invalid TIFF value type. block: ${i.toUpperCase()}, tag: ${s.toString(16)}, type: ${r}, offset ${e}`),e>n.byteLength&&o(`Invalid TIFF value offset. block: ${i.toUpperCase()}, tag: ${s.toString(16)}, type: ${r}, offset ${e} is outside of chunk size ${n.byteLength}`),1===r)return n.getUint8Array(e,a);if(2===r)return""===(c=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(c=n.getString(e,a)).trim())?void 0:c;var c;if(7===r)return n.getUint8Array(e,a);if(1===a)return this.parseTagValue(r,e);{let s=new(function(e){switch(e){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:case 10:default:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 11:return Float32Array;case 12:return Float64Array}}(r))(a),i=h;for(let n=0;n<a;n++)s[n]=this.parseTagValue(r,e),e+=i;return s}}parseTagValue(e,s){let{chunk:i}=this;switch(e){case 1:return i.getUint8(s);case 3:return i.getUint16(s);case 4:case 13:return i.getUint32(s);case 5:return i.getUint32(s)/i.getUint32(s+4);case 6:return i.getInt8(s);case 8:return i.getInt16(s);case 9:return i.getInt32(s);case 10:return i.getInt32(s)/i.getInt32(s+4);case 11:return i.getFloat(s);case 12:return i.getDouble(s);default:o(`Invalid tiff type ${e}`)}}}class de extends ue{static canHandle(e,s){return 225===e.getUint8(s+1)&&1165519206===e.getUint32(s+4)&&0===e.getUint16(s+8)}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let s=this[e]();return void 0!==s.catch&&(s=s.catch(this.handleError)),s}findIfd0Offset(){void 0===this.ifd0Offset&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(void 0===this.ifd1Offset){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),s=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(s)}}parseBlock(e,s){let i=new Map;return this[s]=i,this.parseTags(e,s,i),i}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&o("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&o(`IFD0 offset points to outside of file.\nthis.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,u(this.options));let s=this.parseBlock(this.ifd0Offset,"ifd0");return 0!==s.size?(this.exifOffset=s.get(_),this.interopOffset=s.get(R),this.gpsOffset=s.get(N),this.xmp=s.get(700),this.iptc=s.get(D),this.icc=s.get(M),this.options.sanitize&&(s.delete(_),s.delete(R),s.delete(N),s.delete(700),s.delete(D),s.delete(M)),s):void 0}async parseExifBlock(){if(this.exif)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.exifOffset)return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,u(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(R)),this.makerNote=e.get(E),this.userComment=e.get(j),this.options.sanitize&&(e.delete(R),e.delete(E),e.delete(j)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,s){let i=e.get(s);i&&1===i.length&&e.set(s,i[0])}async parseGpsBlock(){if(this.gps)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.gpsOffset)return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",ce(...e.get(2),e.get(1))),e.set("longitude",ce(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),void 0!==this.interopOffset||this.exif||await this.parseExifBlock(),void 0!==this.interopOffset))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),void 0===this.ifd1)return;let e=this.ifd1.get(513),s=this.ifd1.get(514);return this.chunk.getUint8Array(e,s)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,s,i,n={};for(s of X)if(e=this[s],!l(e))if(i=this.canTranslate?this.translateBlock(e,s):Object.fromEntries(e),this.options.mergeOutput){if("ifd1"===s)continue;Object.assign(n,i)}else n[s]=i;return this.makerNote&&(n.makerNote=this.makerNote),this.userComment&&(n.userComment=this.userComment),n}assignToOutput(e,s){if(this.globalOptions.mergeOutput)Object.assign(e,s);else for(let[i,n]of Object.entries(s))this.assignObjectToOutput(e,i,n)}}function ce(e,s,i,n){var r=e+s/60+i/3600;return"S"!==n&&"W"!==n||(r*=-1),r}t(de,"type","tiff"),t(de,"headerLength",10),O.set("tiff",de);var ye=Object.freeze({__proto__:null,default:ge,Exifr:se,fileParsers:k,segmentParsers:O,fileReaders:I,tagKeys:T,tagValues:z,tagRevivers:F,createDictionary:B,extendDictionary:V,fetchUrlAsArrayBuffer:U,readBlobAsArrayBuffer:x,chunkedProps:$,otherSegments:W,segments:K,tiffBlocks:X,segmentsAndBlocks:H,tiffExtractables:J,inheritables:q,allFormatters:ne,Options:Q,parse:ie});const be={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},ke=Object.assign({},be,{firstChunkSize:4e4,gps:[1,2,3,4]}),Ue=Object.assign({},be,{tiff:!1,ifd1:!0,mergeOutput:!1}),Ce=Object.assign({},be,{firstChunkSize:4e4,ifd0:[274]});async function we(e){let s=new se(Ce);await s.read(e);let i=await s.parse();if(i&&i.ifd0)return i.ifd0[274]}const xe=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});if(s.rotateCanvas=!0,s.rotateCss=!0,"object"==typeof navigator){let e=navigator.userAgent;if(e.includes("iPad")||e.includes("iPhone")){let i=e.match(/OS (\d+)_(\d+)/);if(i){let[,e,n]=i,r=Number(e)+.1*Number(n);s.rotateCanvas=r<13.4,s.rotateCss=!1}}else if(e.includes("OS X 10")){let[,i]=e.match(/OS X 10[_.](\d+)/);s.rotateCanvas=s.rotateCss=Number(i)<15}if(e.includes("Chrome/")){let[,i]=e.match(/Chrome\/(\d+)/);s.rotateCanvas=s.rotateCss=Number(i)<81}else if(e.includes("Firefox/")){let[,i]=e.match(/Firefox\/(\d+)/);s.rotateCanvas=s.rotateCss=Number(i)<77}}class Oe extends p{constructor(...e){super(...e),t(this,"ranges",new ve),0!==this.byteLength&&this.ranges.add(0,this.byteLength)}_tryExtend(e,s,i){if(0===e&&0===this.byteLength&&i){let e=new DataView(i.buffer||i,i.byteOffset,i.byteLength);this._swapDataView(e)}else{let i=e+s;if(i>this.byteLength){let{dataView:e}=this._extend(i);this._swapDataView(e)}}}_extend(e){let s;s=w?y.allocUnsafe(e):new Uint8Array(e);let i=new DataView(s.buffer,s.byteOffset,s.byteLength);return s.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:s,dataView:i}}subarray(e,s,i=!1){return s=s||this._lengthToEnd(e),i&&this._tryExtend(e,s),this.ranges.add(e,s),super.subarray(e,s)}set(e,s,i=!1){i&&this._tryExtend(s,e.byteLength,e);let n=super.set(e,s);return this.ranges.add(s,n.byteLength),n}async ensureChunk(e,s){this.chunked&&(this.ranges.available(e,s)||await this.readChunk(e,s))}available(e,s){return this.ranges.available(e,s)}}class ve{constructor(){t(this,"list",[])}get length(){return this.list.length}add(e,s,i=0){let n=e+s,r=this.list.filter((s=>Se(e,s.offset,n)||Se(e,s.end,n)));if(r.length>0){e=Math.min(e,...r.map((e=>e.offset))),n=Math.max(n,...r.map((e=>e.end))),s=n-e;let i=r.shift();i.offset=e,i.length=s,i.end=n,this.list=this.list.filter((e=>!r.includes(e)))}else this.list.push({offset:e,length:s,end:n})}available(e,s){let i=e+s;return this.list.some((s=>s.offset<=e&&i<=s.end))}}function Se(e,s,i){return e<=s&&s<=i}class Ae extends Oe{constructor(e,s){super(0),t(this,"chunksRead",0),this.input=e,this.options=s}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let s=this.options.chunkSize,i=await this.readChunk(e,s);return!!i&&i.byteLength===s}async readChunk(e,s){if(this.chunksRead++,0!==(s=this.safeWrapAddress(e,s)))return this._readChunk(e,s)}safeWrapAddress(e,s){return void 0!==this.size&&e+s>this.size?Math.max(0,this.size-e):s}get nextChunkOffset(){if(0!==this.ranges.list.length)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return void 0!==this.size&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}I.set("blob",class extends Ae{async readWhole(){this.chunked=!1;let e=await x(this.input);this._swapArrayBuffer(e)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(e,s){let i=s?e+s:void 0,n=this.input.slice(e,i),r=await x(n);return this.set(r,e,!0)}}),s.Exifr=se,s.Options=Q,s.allFormatters=ne,s.chunkedProps=$,s.createDictionary=B,s.default=ye,s.extendDictionary=V,s.fetchUrlAsArrayBuffer=U,s.fileParsers=k,s.fileReaders=I,s.gps=async function(e){let s=new se(ke);await s.read(e);let i=await s.parse();if(i&&i.gps){let{latitude:e,longitude:s}=i.gps;return{latitude:e,longitude:s}}},s.gpsOnlyOptions=ke,s.inheritables=q,s.orientation=we,s.orientationOnlyOptions=Ce,s.otherSegments=W,s.parse=ie,s.readBlobAsArrayBuffer=x,s.rotation=async function(e){let i=await we(e);return Object.assign({canvas:s.rotateCanvas,css:s.rotateCss},xe[i])},s.rotations=xe,s.segmentParsers=O,s.segments=K,s.segmentsAndBlocks=H,s.tagKeys=T,s.tagRevivers=F,s.tagValues=z,s.thumbnail=async function(e){let s=new se(Ue);await s.read(e);let i=await s.extractThumbnail();return i&&w?y.from(i):i},s.thumbnailOnlyOptions=Ue,s.thumbnailUrl=async function(e){let s=await this.thumbnail(e);if(void 0!==s){let e=new Blob([s]);return URL.createObjectURL(e)}},s.tiffBlocks=X,s.tiffExtractables=J,Object.defineProperty(s,"__esModule",{value:!0})}(s)}()}).call(this,i("n3a2"),i("E0jC"),i("5scI").Buffer)}}]);